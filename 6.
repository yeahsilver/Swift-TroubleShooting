# Suspend ìƒíƒœì—ì„œ ìœ„ì¹˜ ì¶”ì í•˜ê¸°

ë‹´ë‹¹ì: ella Heo
íƒœê·¸: iOS

<aside>
ğŸ’¡ **ì—˜ë¼ì˜ ê°œë°œ íƒí—˜ ë¬¸ì„œ (í•´ë‹¹ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì‹œë„í•´ë³¸ ê²ƒ)**
[Suspend ìƒíƒœì—ì„œë„ ìœ„ì¹˜ ì¶”ì ì„ í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì€ ë¬´ì—‡ì¼ê¹Œ?](https://www.notion.so/Suspend-41b6555f91d34ab1ad73384bd4f1f538)

</aside>

ğŸ“**ëª©ì°¨ğŸ“**

---

### 1. ê°œìš”

í•´ë‹¹ ë¬¸ì„œëŠ” iOS í™˜ê²½ì—ì„œ suspendì‹œ ìœ„ì¹˜ ì¶”ì  ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ ì‹œë„í•œ ì—¬ëŸ¬ê°€ì§€ ë°©ì‹ì´ ê¸°ì¬ë˜ì–´ìˆìŠµë‹ˆë‹¤. í•´ë‹¹ ë¬¸ì„œëŠ” suspendì‹œ ìœ„ì¹˜ ì¶”ì ì„ ì§„í–‰í•˜ëŠ” ë¡œì§ì˜ ì–´ë ¤ì›€ê³¼ ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œ iOS built-in í”„ë ˆì„ì›Œí¬ **CoreLocation**ì˜ ì¼ë¶€ ê¸°ëŠ¥ì¸ **Geo Fencing** ì„ í†µí•œ suspendì‹œ ìœ„ì¹˜ ì¶”ì  êµ¬í˜„ ë°©ì‹ì— ëŒ€í•´ ì„¤ëª…í•©ë‹ˆë‹¤.

### 2. ë¬¸ë§¥

- Foreground /Background ìƒíƒœë¥¼ ê°€ì§€ê³  ìˆëŠ” ê²½ìš° ìœ„ì¹˜ ì¶”ì ì´ ì •ìƒì ìœ¼ë¡œ ì´ë£¨ì–´ì§€ì§€ë§Œ **suspend ìƒíƒœì—ì„œëŠ” ì •ìƒì ìœ¼ë¡œ ìœ„ì¹˜ ì¶”ì ì´ ë¶ˆê°€í•œ ë¬¸ì œ**ë¥¼ ì§ë©´í•˜ì˜€ìŠµë‹ˆë‹¤.
    
    ì—¬ê¸°ì„œ Foreground ìƒíƒœëŠ” ì•± í™”ë©´ì´ ê¸°ê¸°ì— ì¶œë ¥ë˜ëŠ” ìƒíƒœ, Background ìƒíƒœëŠ” ì•± í™”ë©´ì´ ê¸°ê¸°ì— ì¶œë ¥ ë˜ì§€ ì•Šì§€ë§Œ ì•± ì‹¤í–‰ ë¦¬ìŠ¤íŠ¸ì—  ì¡´ì¬í•˜ëŠ” ìƒíƒœ, ê·¸ë¦¬ê³  suspend ìƒíƒœëŠ” ì•±ì´ ì™„ì „íˆ ì£½ì€ ìƒíƒœë¥¼ ë§í•©ë‹ˆë‹¤.
    
- â€œWolleyâ€ í”Œë«í¼ì€ ì‚¬ìš©ìì˜ **ìœ„ì¹˜ ì •ë³´ë¥¼ ê¸°ë°˜**ìœ¼ë¡œ ì‹œê°„í‘œë¥¼ ê·¸ë ¤ì£¼ê³ , ì‚¬ìš©ìê°€ ë¨¸ë¬¸ ì¥ì†Œ, ê·¸ë¦¬ê³  ì‚¬ìš©ìì˜ ì´ë™ ë™ì„ ì„ ì œê³µí•˜ì—¬ ì‚¬ìš©ìê°€ í•´ë‹¹ ì •ë³´ë¥¼ ê°€ì‹œì ìœ¼ë¡œ ë³´ì—¬ì£¼ëŠ” ê¸°ëŠ¥ì´ í•„ìš”í•˜ê¸°ì—, suspend ìƒíƒœì—ì„œë„ ìœ„ì¹˜ ì¶”ì ì´ ê°€ëŠ¥í•´ì•¼í•©ë‹ˆë‹¤.
- Suspend ì‹œì—ë„ ìœ„ì¹˜ ì¶”ì ì´ ê°€ëŠ¥í•¨ì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ì„œëŠ” **ë””ë²„ê·¸ ìƒíƒœì˜ ì•±ì„ ì™„ì „íˆ ì£½ì€ ìƒíƒœì˜ í™˜ê²½**ìœ¼ë¡œ ë§Œë“ ê³  í•´ë‹¹ ê¸°ê¸°ë¥¼ ê°€ì§€ê³  ìœ„ì¹˜ë¥¼ ì´ë™í•  ì‹œ íŠ¹ì • ë²”ìœ„(ì•½ 200m)ë¥¼ ë„˜ì„ ê²½ìš° ì•„ë˜ì™€ ê°™ì€ ì•ŒëŒì´ ì¶œë ¥ëœë‹¤ë©´ í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µí•œ ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
    
    ![KakaoTalk_Photo_2022-02-24-15-40-17.jpeg](Suspend%20%E1%84%89%E1%85%A1%2027e45/KakaoTalk_Photo_2022-02-24-15-40-17.jpeg)
    

### 3. ëª©í‘œ

- ì•±ì˜ ìƒíƒœê°€ ì–´ë–»ë˜ì§€ ê°„ì— ì‚¬ìš©ìì˜ ë™ì„ ì„ ì •í™•í•˜ê²Œ ì¶”ì í•´ í•˜ë£¨ì˜ ë™ì„ ì„ ê·¸ë ¤ì£¼ê³ , ì‚¬ìš©ìê°€ ë¨¸ë¬¸ ì¥ì†Œ, ê·¸ë¦¬ê³  ì‚¬ìš©ìì˜ ì´ë™ ë™ì„  ê¸°ëŠ¥ì„ ì œê³µí•¨ìœ¼ë¡œì¨ **â€œìë™ìœ¼ë¡œ ê¸°ë¡ë˜ëŠ” ë‚´ ì‚¶"ì´ë¼ëŠ” ê°€ì¹˜ë¥¼ ì‚¬ìš©ìì—ê²Œ ë¶€ì—¬**í•©ë‹ˆë‹¤.
- suspend ì‹œ ìœ„ì¹˜ ì¶”ì  ì„±ê³µ ì—¬ë¶€ë¥¼ ì¸¡ì •í•˜ê¸° ìœ„í•´ ìœ„ì¹˜ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ” ì„œë²„ ê²½ë¡œì¸ /path/daily ë¶€ë¶„ì—ì„œ ì—˜ë¼ì˜ ë™ì„  ë°ì´í„°ë¥¼ json í˜•íƒœë¡œ íšë“í•˜ì—¬ ì§€ë„ë·°ì— í•´ë‹¹ ì¢Œí‘œë¥¼ í•€ìœ¼ë¡œ ì¶œë ¥í•œ í›„, **ì—˜ë¼ì˜ ë™ì„ ê³¼ ì¼ì¹˜í•˜ë©´ ìœ„ì¹˜ ì¶”ì  ì„±ê³µ**ìœ¼ë¡œ ê°„ì£¼í•˜ì˜€ìŠµë‹ˆë‹¤.
    
    ![KakaoTalk_Photo_2022-02-24-16-06-40.png](Suspend%20%E1%84%89%E1%85%A1%2027e45/KakaoTalk_Photo_2022-02-24-16-06-40.png)
    

### 4. í•´ë‹¹ ê¸°ìˆ  êµ¬í˜„ì´ ì–´ë ¤ìš´ ì´ìœ 

- ê¸°ì¡´ì— ì¡´ì¬í•˜ëŠ” ìœ„ì¹˜ ê¸°ë°˜ ì„œë¹„ìŠ¤ë“¤ì€ ëª¨ë‘ foregroundì™€ background ì²˜ë¦¬ë§Œ ë˜ì–´ìˆëŠ” ê²½ìš°ê°€ ëŒ€ë‹¤ìˆ˜ì˜€ìŠµë‹ˆë‹¤.
    - ê¸°ë³¸ì ìœ¼ë¡œ ìœ„ì¹˜ ì¶”ì  ê¸°ëŠ¥ì„ ìˆ˜í–‰í•  ë•Œ, Core Locationì˜ ê¸°ëŠ¥ì¸ **Standard Location Service**ë¥¼ ì‚¬ìš©í•˜ë©´ ì‚¬ìš©ìì˜ ìœ„ì¹˜ ì„œë¹„ìŠ¤ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        
        ![ìŠ¤í¬ë¦°ìƒ· 2022-02-26 ì˜¤í›„ 3.10.55.png](Suspend%20%E1%84%89%E1%85%A1%2027e45/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-02-26_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.10.55.png)
        
    - ì—¬ê¸°ì„œ Stanard Location ServiceëŠ” ì‚¬ìš©ìì˜ ìœ„ì¹˜ ì •ë³´ë¥¼ **ì‹¤ì‹œê°„ (Real time)**ìœ¼ë¡œ ë°›ì•„ì˜¤ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.
    - í•´ë‹¹ ë°©ì‹ì€ **ì‹¤ì‹œê°„**ìœ¼ë¡œ ë°›ì•„ì˜¤ëŠ” ë°©ì‹ì´ê¸°ì—, **ì •í™•í•œ ìœ„ì¹˜ ì •ë³´ë¥¼ ì œê³µ**í•©ë‹ˆë‹¤.
- Foregroundì‹œì—ëŠ” ì‹¤ì‹œê°„ìœ¼ë¡œ ìœ„ì¹˜ ì¶”ì ì„ í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ (Standard Location Service)ì„ ì œê³µí•˜ê¸°ì— í•´ë‹¹ ë°©ì‹ì„ ì½”ë“œë¡œ ë©”ì†Œë“œí™”í•˜ì—¬ í•´ë‹¹ ìƒíƒœì—ì„œì˜ ìœ„ì¹˜ ì¶”ì ì€ ì‰½ê²Œ ì„±ê³µí–ˆìœ¼ë‚˜ ë·°ê°€ ì‹¤í–‰ë˜ì§€ ì•Šì„ ì‹œ ìœ„ì¹˜ ì¶”ì  ì ìš© ì—¬ë¶€ í…ŒìŠ¤íŒ…ì„ ìˆ˜í–‰í•´ë´¤ê³ , **í…ŒìŠ¤íŒ…ì„ ì‹¤íŒ¨**í•˜ê³  ë§ì•˜ìŠµë‹ˆë‹¤.
    - ì´ìœ ë¥¼ ì„œì¹˜í•´ë³´ë‹ˆ, Background ìƒíƒœì—ì„œ ì‹¤í–‰í•˜ê²Œ í•˜ë ¤ë©´ XCodeì—ì„œ background mode - Location Update ë¶€ë¶„ì— ëŒ€í•´ ì²˜ë¦¬í•´ì£¼ì–´ì•¼ í–ˆì—ˆê¸° ë•Œë¬¸ì´ì—ˆìŠµë‹ˆë‹¤.
- ê·¸ëŸ¬ë©´ ì´ì œ background modeë¥¼ ì²˜ë¦¬í•˜ë©´ ë·°ê°€ ì‹¤í–‰ë˜ì§€ ì•Šì„ ë•Œì—ë„ ì ìš©ì´ ë˜ê² ì§€? ë¼ê³  í•´ë‹¹ ì„¤ì •ì„ ì¶”ê°€í•œ í›„ í•´ë‹¹ ê²½ìš°ì— ìœ„ì¹˜ ì •ë³´ê°€ ì…ë ¥ì´ ë ê¹Œ? ë¼ëŠ” ê¸°ëŒ€ë¥¼ í•˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤.
    - ì—˜ë¼ì˜ ì¶œí‡´ê·¼ê¸¸ (ë™ì‘êµ¬ ìƒë„ë™ â†” íŒêµ)ë¥¼ ë‹¤ë‹ˆë©° backgroudì™€ suspend ìƒíƒœì¼ ë–„ì˜ ìœ„ì¹˜ ì¶”ì ì´ ì–´ë–»ê²Œ ë˜ëŠ”ì§€ ì¸¡ì •í•´ë³´ì•˜ìŠµë‹ˆë‹¤. background ëª¨ë“œì—ì„œëŠ” ì‹¤ì‹œê°„ìœ¼ë¡œ ìœ„ì¹˜ ì¶”ì  ì²˜ë¦¬ê°€ ì˜ ë˜ì—ˆì§€ë§Œ, suspend ìƒíƒœì—ì„œëŠ” í…ŒìŠ¤íŒ…ì´ ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤.
    - ì´ìœ ê°€ ë¬´ì—‡ì¸ê°€ í•˜ì˜€ë”ë‹ˆ, Standard Location ServiceëŠ” **Foreground/Background í™˜ê²½ì—ì„œë§Œ ëŒì•„ê°€ëŠ” ê¸°ëŠ¥**ì´ì˜€ìŠµë‹ˆë‹¤.
- ê·¸ëŸ¬ë©´ ì–´ë–»ê²Œ suspend ì‹œì—ë„ ìœ„ì¹˜ ì¶”ì ì„ í•  ìˆ˜ ìˆì„ê¹Œë¼ëŠ” ì˜ë¬¸ì¦ì´ ìƒê¸°ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
- ì• í”Œ ë¬¸ì„œì—ì„œë„ suspendì‹œ ìœ„ì¹˜ ì¶”ì ì„ ì§„í–‰í•˜ëŠ” ì˜ˆì‹œê°€ ì¡´ì¬í•˜ì§€ ì•Šì•˜ê¸°ì— í•´ë‹¹ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ë©° ë‚œê´€ì— ë´‰ì°©í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
    
    ì‹¬ì§€ì–´ apple commnuity ì¹´ì¹´ì˜¤í†¡ ë‹¨ì²´í†¡ë°©ì—ì„œë„ ì§ˆë¬¸ì„ ë˜ì ¸ë³´ì•˜ìœ¼ë‚˜ ê°œë°œìë¶„ë“¤ì´ suspendì—ì„œ ê¸°ëŠ¥ë“¤ì„ ì²˜ë¦¬í•˜ëŠ”ê²ƒ ìì²´ê°€ ì–´ë µë‹¤ê³  í¬ê¸°í•˜ë¼ê³  í•˜ì…¨ìŠµë‹ˆë‹¤....ğŸ¥²
    
- ì„œì¹˜í•´ë³¸ ê²°ê³¼, ì• í”Œ OS ì¸¡ì—ì„œ suspendì‹œì— ì‚¬ìš©ììœ„ì¹˜ë¥¼ **ì‹¤ì‹œê°„**ìœ¼ë¡œ ì¶”ì í•˜ëŠ” ê¸°ëŠ¥ ìì²´ë¥¼ ì°¨ë‹¨í•˜ì˜€ê¸°ì—, ì‚¬ìš©ìì˜ ì‹¤ì‹œê°„ ìœ„ì¹˜ ì •ë³´ëŠ” suspend ìƒíƒœì—ì„œëŠ” ì œê³µ ë°›ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
    
    í•˜ì§€ë§Œ ì €ëŠ” í¬ê¸°í•˜ì§€ ì•ŠëŠ” ì—´ì • ì—˜ë¼ì…ë‹ˆë‹¤. ì—¬ëŸ¬ ê°€ì§€ ë°©ë²•ì„ ì°¾ì•„ ì‹œë„í•´ë³´ì•˜ìŠµë‹ˆë‹¤.
    

### 5. ì‹œë„í•œ (ì‹¤íŒ¨) ë°©ì‹

**ì´ˆê¸° ì„¸íŒ…** 

App Delegateì—ì„œ Background ìƒíƒœë¡œ ë“¤ì–´ê°€ê¸° 

- Background ìƒíƒœë¥¼ App Delegateì—ì„œ ì²˜ë¦¬í•´ì„œ **ë¨¸ë¬¼ëŸ¬ ìˆëŠ” ìœ„ì¹˜ì—ì„œ ì´ë™í•˜ê²Œ ë˜ë©´ ë³€í™”ëœ ìœ„ì¹˜ë¥¼ ì²´í¬í•˜ëŠ” ë°©ì‹**ìœ¼ë¡œ ê°œë°œì„ í•´ë³´ë©´ ì–´ë–¨ê¹Œë¼ëŠ” ì˜ë¬¸ì´ ë“¤ì—ˆìŠµë‹ˆë‹¤.
    - App Delegateì—ì„œ applicationDidEnterBackground() ë©”ì†Œë“œë¥¼ ì¶”ê°€í•˜ì—¬ ë°±ê·¸ë¼ìš´ë“œ ìƒíƒœì— ì§„ì…ì‹œì— **ìœ„ì¹˜ ëª¨ë‹ˆí„°ë§ ì½”ë“œë¥¼ ì¶”ê°€**í•©ë‹ˆë‹¤.
    
    ```swift
    func applicationDidEnterBackground(_ application: UIApplication) {
            print("application Did Enter Background")
            startMySignificantLocationChanges()
    }
        
    private func startMySignificantLocationChanges() {
    				// ëª¨ë‹ˆí„°ë§ ì²´í¬ê°€ ë˜ì–´ìˆì§€ ì•Šìœ¼ë©´ ìœ„ì¹˜ ëª¨ë‹ˆí„°ë§ì´ ë¶ˆê°€. í•´ë‹¹ ë¶€ë¶„ì„ ì²˜ë¦¬
    	if !CLLocationManager.significantLocationChangeMonitoringAvailable() {
           print("significant location change monitoring is not availiable")
           return
      }
            
      locationSerivces.startMonitoringSignificantLocationChanges()
    }
    ```
    
- ì½”ë“œëŠ” êµ¬í˜„ ì™„ë£Œ í•˜ì˜€ëŠ”ë°.. ê·¸ëŸ¬ë©´ ì–˜ê°€ ì˜ ì¶”ì ë˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ë°©ë²•ì´ ë¬´ì—‡ì¼ê¹Œ?
    - CLLocationManagerì— ì†í•´ìˆëŠ” `startMonitoringSignificantLocationChanges()` ë©”ì†Œë“œ ì‚¬ìš©í•´ë³´ì!

**startMonitoringSignificantLocationChanges() ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ìœ„ì¹˜ ë³€ê²½ ì‹œ ë…¸í‹° ë°›ê¸°**

- **ì˜ë¬¸ì **
    - ëŒ€ì²´ ëª‡ë¯¸í„°ë¥¼ ê°€ì•¼ ìœ„ì¹˜ê°€ ë³€ê²½ë˜ì—ˆë‹¤ê³  ì¸ì‹í• ê¹Œ?
    - suspendì—ì„œ ìœ„ì¹˜ ë³€ê²½ ì—¬ë¶€ë¥¼ ì²˜ë¦¬í•˜ëŠ”ë°, í•´ë‹¹ ì•Œë¦¼ì€ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•´ì•„í• ê¹Œ?
- suspend ìƒíƒœì—ì„œë„ ìœ„ì¹˜ ì •ë³´ ì¶”ì ì´ ì˜ ë˜ê³  ìˆëŠ”ì§€ ì²´í¬ ë°©ë²•
    - ì• í”Œ ë¬¸ì„œ ì™ˆ
        
        [Apple Developer Documentation](https://developer.apple.com/documentation/corelocation/cllocationmanager/1423531-startmonitoringsignificantlocati)
        
        - ì•±ì´ ì¢…ë£Œ ì‹œ, ìƒˆë¡œìš´ ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ë©´ ì•±ì´ ì¬ì‹¤í–‰ë©ë‹ˆë‹¤. ì—¬ê¸°ì„œ app delegateì˜ willFinishLaunchingWithOptions, ê·¸ë¦¬ê³  didFinishLaunchingWithOptionsì—ì„œ location í‚¤ê°€ ë„˜ì–´ì˜µë‹ˆë‹¤. (í•´ë‹¹ ë©”ì†Œë“œëŠ” ì¥ì†Œ ë³€í™” ì•¡ì…˜ ë•Œë¬¸ì— ì•±ì´ ì¬ì‹¤í–‰ëì–´!!! ë¼ëŠ” ì´ë²¤íŠ¸ë¥¼ ì•Œë ¤ì£¼ëŠ” ì—­í• ì…ë‹ˆë‹¤.)
            - ë‘ê°œì˜ ì°¨ì´ì ì€ ë¬´ì—‡ì¼ê¹Œ?
                - willFinishLaunchingWithOptions(): ì•±ì„ ì´ˆê¸°í™”í•˜ê³  ì‹¤í–‰ ì¤€ë¹„ (ì•±ì´ ì‹¤í–‰ëœ í›„ì— storyboard ë˜ëŠ” nibì´ ë¡œë“œ ë˜ê³  ì‹¤í–‰) â‡’ í•´ë‹¹ ë©”ì†Œë“œ ì‹¤í–‰ ì‹œ ì•±ì€ inactive ìƒíƒœ
                - didFinishLaunchingWithOptions(): í”„ë¡œì„¸ìŠ¤ê°€ ê±°ì˜ ì™„ë£Œë˜ì–´ê°€ê³  ì•±ì´ ì‹¤í–‰ë  ì¤€ë¹„ê°€ ë˜ì—ˆë‹¤ëŠ” ê²ƒì„ ì•Œë¦¬ëŠ” ë©”ì†Œë“œ
        - ê·¸ëŸ¬ë©´ í‚¤ëŠ” ì–´ë””ì— ì €ì¥ ë˜ì–´ ìˆì„ê¹Œ?
            - `launchOptions: [UIApplication.LaunchOptionsKey: **Any**]`ì— ì €ì¥
                - í‚¤ì—ëŠ” ì–´ë–¤ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆì„ê¹Œ?
                    - location í‚¤ë¥¼ ì–´ë–»ê²Œ ê°€ì§€ê³  ì˜¬ê¹Œ?
                        
                        launchOptionsì—ëŠ” ì—¬ëŸ¬ê°€ì§€ Keyê°€ ì¡´ì¬í•˜ëŠ”ë°, ì—¬ê¸°ì„œ .locationì˜ í‚¤ë¥¼ ë¶ˆëŸ¬ì˜¤ë©´ ë˜ëŠ” ê²ƒ ê°™ë‹¤.
                        
                        (lauchOptions: ì•±ì´ ì‹œì‘ëœ ì´ìœ ê°€ ë‹´ê²¨ìˆëŠ” dictionary. ì‚¬ìš©ìê°€ ì§ì ‘ ì•±ì„ ì‹¤í–‰í•œ ê²½ìš°ì—ëŠ” nilê°’ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.)
                        
                        ```swift
                        if let location = launchOptions?[.location] as? [AnyHashable: Any] {
                        	// ì½”ë“œ ì‘ì„± ì£¼ë¥´ë¥´ë¥´ë¥µ
                        }
                        ```
                        
                    - ê·¸ëŸ¬ë©´ í‚¤ëŠ” ì–´ë–¤ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆì„ê¹Œ? ê·¸ë¦¬ê³  ë‚˜ì•„ê°€ ì–´ë–¤ ì—­í• ì„ ìˆ˜í–‰í• ê¹Œ?
- suspendì—ì„œ ì¥ì†Œê°€ ë°”ë€ŒëŠ” ê²ƒì„ í™•ì¸ í•˜ê¸° ìœ„í•´ì„œëŠ”, locationì´ í˜¸ì¶œë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ì•¼í•©ë‹ˆë‹¤.
    
    ì—¬ê¸°ì„œ locationì˜ í‚¤ë¥¼ ê°€ì§€ê³  ìˆëŠ” ê³³ì€ launchOptionsì´ê¸°ì—, .locationì—ì„œ í˜¸ì¶œì´ ì˜¨ë‹¤ë©´ ë¡œì»¬ notificationì„ ë„ìš°ëŠ” í˜•íƒœë¡œ ì¼ë‹¨ ì§„í–‰ì„ í•´ë³´ì•˜ìŠµë‹ˆë‹¤. (ì•„ë‹ˆë©´ suspend ìƒíƒœì—ì„œ í•´ë‹¹ ê²ƒì´ ì˜ ì˜¤ê³  ìˆëŠ”ì§€ í™•ì¸ í•˜ê¸°ê°€ êµ‰ì¥íˆ ì–´ë ¤ì›€. ë‚´ê°€ ì»´í“¨í„°ì˜€ìœ¼ë©´ ì¢‹ê² ë‹¤.) 
    
    â‡’ ë°±ê·¸ë¼ìš´ë“œ ì „í™˜ì‹œ ë…¸íŠ¸ ì•Œë¦¬ê¸° ì²˜ë¦¬
    
    â‡’ ê·¸ëŸ¬ë©´ suspendì‹œì— ë…¸í‹°ëŠ” ê°€ëŠ¥í• ê¹Œ?
    
    â‡’ ì„œì¹˜ ê²°ê³¼ ë˜ëŠ” ê²ƒ ê°™ë‹¤! location í‚¤ê°€ ì˜¤ë©´ ë³€ê²½ ìœ„ì¹˜ ë…¸í‹° ë„ìš°ë„ë¡ í•´ì„œ, í…ŒìŠ¤íŒ… í•„ìš” (1/6 ì§‘ ê°€ë©´ì„œ í…ŒìŠ¤íŒ…) â‡’ **í…ŒìŠ¤íŒ… ì‹¤íŒ¨**
    
    ì¶”í›„ ê°œë°œí•˜ë‹¤ ì¸ì§€í•œ ì‚¬ì‹¤ì´ì§€ë§Œ, ì‹¤íŒ¨ ì´ìœ ëŠ” ì•ŒëŒì´ ì˜¨ ë’¤, ì•ŒëŒì„ í´ë¦­í•´ì•¼ ë¡œì¼€ì´ì…˜ í‚¤ì— ë§ê²ŒAppDelegateì˜ ì•Œë¦¼ ì²˜ë¦¬ ë©”ì†Œë“œë¥¼ ì²˜ë¦¬í•˜ëŠ” ê²ƒì„ ì•Œì•˜ê³  ìœ„ì˜ ì´ìœ ê°€ í•´ë‹¹ ê¸°ëŠ¥ì˜ ì‹¤íŒ¨ ì´ìœ ì˜€ìŠµë‹ˆë‹¤.
    

**Background Fetchë¡œ terminated ê°ì§€ í›„ ì²˜ë¦¬**

- UIApplicationBackgroundFetchIntervalMinimum â‡’ ìœ„ì¹˜ë¥¼ ì €ì¥í•˜ê³  ì‹¶ì€ ì‹œê°„ëŒ€ë¥¼ ì§€ì •í•´ì„œ ë¡œì»¬ ìì²´ë¡œ íƒ€ì´ë¨¸ë¥¼ ê±¸ì–´ì„œ ê³„ì† Background Fetchí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•˜ìë¼ëŠ” ìƒê°ì„ í•˜ì˜€ìŠµë‹ˆë‹¤.
    
    â‡’ í•´ë‹¹ ë©”ì†Œë“œê°€ deprecatedë˜ì–´ êµ¬í˜„í•  ìˆ˜ ìˆëŠ” ë‹¤ë¥¸ ë°©í–¥ì„±ì„ ì°¾ì•„ë³´ì•„ì•¼ í–ˆìŠµë‹ˆë‹¤.
    

### 6. í•´ê²° ë°©ì‹

**(í† ê¸€ì„ ì—´ë©´ ìì„¸í•œ ì½”ë“œë¥¼ ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤)**

- Geo fencing ê¸°ëŠ¥ ì‚¬ìš©í•˜ì—¬ suspendì‹œ ìœ„ì¹˜ ì¶”ì  ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.
- ì™œ Geofencingì„ ì„ íƒí•˜ì˜€ëŠ”ê°€?
    - Geo Fencing ê¸°ëŠ¥ì€ í•œ ìœ„ì¹˜ë¥¼ í•€ìœ¼ë¡œ ì°ì€ í›„ í•´ë‹¹ ìœ„ì¹˜ì—ì„œ ë°˜ê²½ 200m ì´ìƒ ë²—ì–´ë‚˜ë©´ í˜¸ì¶œí•´ì£¼ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.
    - ê·¸ëŸ¬ë©´ Geo Fencingì„ ì´ìš©í•˜ì—¬ ë°˜ê²½ 200më¥¼ ë„˜ì–´ê°ˆ ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ ìœ„ì¹˜ë¥¼ fencingí•´ì„œ ê³„ì†ì ìœ¼ë¡œ ìœ„ì¹˜ ì¶”ì ì„ ì§„í–‰í•˜ë©´ ì–´ë–¨ê¹Œ?ë¼ëŠ” ì˜ë¬¸ì ì´ ìƒê²¼ê³ , ë°”ë¡œ êµ¬í˜„ì— ë“¤ì–´ê°”ìŠµë‹ˆë‹¤.
- Geo Fencing ê¸°ëŠ¥ì€ iOSì˜ built-in frameworkì¸ CoreLocationì—ì„œ ì œê³µì„ í•˜ë©°, í•´ë‹¹ í”„ë ˆì„ì›Œí¬ì˜ `CLLocationManager`ë¥¼ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.
- ì‚¬ìš©ìê°€ ì²˜ìŒìœ¼ë¡œ SummaryViewë¥¼ ë¡œë”©í•  ì‹œ ìœ„ì¹˜ ì¶”ì ì„ ë‹´ë‹¹í•˜ëŠ” í´ë˜ìŠ¤ì¸ `LocationService` í´ë˜ìŠ¤ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. Location Serviceì—ì„œì˜ ìœ„ì¹˜ ì¶”ì  ë° í•´ì œëŠ” ì•„ë˜ì™€ ê°™ì´ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.
    
    **ìœ„ì¹˜ ì¶”ì  ì‹œì‘ ì½”ë“œ**
    
    ```swift
    /// ì¥ì†Œ ëª¨ë‹ˆí„°ë§ì„ ì‹œì‘í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
    func startMonitoringLocation() {
        guard let latitude = locationManager.location?.coordinate.latitude,
              let longitude = locationManager.location?.coordinate.longitude else { return }
        
        let location  = CLLocationCoordinate2D(latitude: latitude, longitude: longitude)
        
        let region = CLCircularRegion(center: location, radius: 1.0, identifier: "location")
        region.notifyOnEntry = false
        region.notifyOnExit = true
        
        locationManager.startMonitoring(for: region)
        locationManager.startUpdatingLocation()
    }
    ```
    
    **ìœ„ì¹˜ ì¶”ì  í•´ì œ ì½”ë“œ**
    
    ```swift
    /// ì¥ì†Œ ëª¨ë‹ˆí„°ë§ì„ í•´ì œí•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
    func stopMonitoringLocation() {
        let monitoredRegions = locationManager.monitoredRegions
    
        for region in monitoredRegions {
            locationManager.stopMonitoring(for: region)
        }
    }
    ```
    
- ì—¬ê¸°ì„œ í•´ë‹¹ ì•±ì€ suspendì‹œì— ì¶”ì ë˜ëŠ” ìœ„ì¹˜ ë˜í•œ ì €ì¥í•´ì•¼í•˜ê¸°ì—, ë¡œì»¬ DB built-in í”„ë ˆì„ì›Œí¬ì¸ CoreDataë¥¼ ì‚¬ìš©í•˜ì—¬ ìœ„ì¹˜ ë³€ê²½ì´ ê°ì§€ëœ ê²½ìš° ë¡œì»¬ ê¸°ê¸°ì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ì˜€ìŠµë‹ˆë‹¤.
    
    ```swift
    /// í˜„ì¬ ì¥ì†Œë¥¼ ìœ„ë„, ê²½ë„ í˜•ì‹ìœ¼ë¡œ ë¡œì»¬ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
    func saveLocation() {
         let entity = NSEntityDescription.entity(forEntityName: "Location", in: self.container.viewContext)!
            
          guard let latitude = locationManager.location?.coordinate.latitude,
                  let longitude = locationManager.location?.coordinate.longitude else { return }
            
          let speed = String((locationManager.location?.speed) ?? 0)
            
          let location = NSManagedObject(entity: entity, insertInto: self.container.viewContext)
            location.setValue("\(getCurrentTime())", forKey: "time")
            location.setValue([String(latitude), String(longitude)], forKey: "coordinate")
            location.setValue(speed, forKey: "speed")
            
          do {
               try self.container.viewContext.save()
                
          } catch {
             WolleyLog.error(error.localizedDescription)
          }
      }
    ```
    

- ì—¬ê¸°ì„œ ë¡œì»¬ DBì˜ êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.
    
    ![ìŠ¤í¬ë¦°ìƒ· 2022-02-24 ì˜¤í›„ 4.28.13.png](Suspend%20%E1%84%89%E1%85%A1%2027e45/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-02-24_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.28.13.png)
    

- ê·¸ëŸ¬ë©´ ìƒˆë¡œìš´ ì¥ì†Œì— ëŒ€í•œ ì²˜ë¦¬ëŠ” ì–´ë–»ê²Œ í•´ì•¼í•˜ë‚˜ìš”? ë¼ëŠ” ë¬¼ìŒì´ ìƒê¸¸ ìˆ˜ ìˆëŠ”ë° í•´ë‹¹ ë¶€ë¶„ì€ ì•„ë˜ì™€ ê°™ì´ ì²˜ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.
    
    **ìœ„ì¹˜ ë³€ê²½ ê°ì§€ ì½”ë“œ**
    
    ```swift
    /// ìƒˆë¡œìš´ ì¥ì†Œì— ì§„ì…í–ˆì„ ê²½ìš° ìƒˆ ì¥ì†Œë¥¼ ëª¨ë‹ˆí„°ë§í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
    func locationManager(_ manager: CLLocationManager, didDetermineState state: CLRegionState, for region: CLRegion) {
        switch state {
            case .inside:
                WolleyLog.debug("inside")
                break
                
            case .outside:
                WolleyLog.debug("outside")
                saveLocation()
                stopMonitoringLocation()
                startMonitoringLocation()
                break
                
            case .unknown:
                break
        }
    }
    ```
    

- ì‚¬ìš©ìê°€ ì•±ì„ ì‹¤í–‰í•  ì‹œ, ë¡œì»¬ DB ì— ì €ì¥ë˜ì–´ ìˆë˜ ìœ„ì¹˜ ì •ë³´ë¥¼ ì„œë²„ì— ì „ì†¡í•´ì•¼í•˜ê¸°ì—, ë¡œì»¬ DBì˜ ë°ì´í„°ë¥¼ fetchí•˜ì—¬ ë„¤íŠ¸ì›Œí¬ í†µì‹  ë¶€ë¶„ì— ì „ì†¡í•©ë‹ˆë‹¤.
    
    **ë¡œì»¬ DB ë°ì´í„° fetch ì½”ë“œ**
    
    ```swift
    /// ë¡œì»¬ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ë˜ì–´ìˆëŠ” ì¥ì†Œ ì •ë³´ë¥¼ ë°©ì¶œì‹œí‚¤ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
    func fetchLocation(completion: @escaping ([DailyPathTimeRequest]) -> Void) {
        do {
            let location = try self.container.viewContext.fetch(Location.fetchRequest())
            
            if location.isEmpty {
                WolleyLog.debug("Fetch ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.")
                completion([])
                
            } else {
                var data: [DailyPathTimeRequest] = []
                
                location.forEach {
                    let time = $0.time!
                    let coordinate = $0.coordinate!
                    
                    let latitude = coordinate[0].floatValue
                    let longitude = coordinate[1].floatValue
    	 
     
                    data.append(DailyPathTimeRequest(time: time, coordinates: DailyPathCoordinate(latitude: latitude, longitude: longitude)))
                    
                    WolleyLog.debug(time, coordinate)
                }
                
                completion(data)
            }
        } catch {
            WolleyLog.error(error.localizedDescription)
        }
    }
    ```
    

- ì´í›„ í´ë¼ì´ì–¸íŠ¸ ë¶€ë¶„ì—ì„œ ë°ì´í„°ë¥¼ íŒŒê¸°í•©ë‹ˆë‹¤.
    
    **ë¡œì»¬ DB ë°ì´í„° ì œê±° ì½”ë“œ**
    
    ```swift
    /// ë¡œì»¬ ë°ì´í„°ë² ì´ìŠ¤ì˜ ëª¨ë“  ì •ë³´ë¥¼ ì œê±°í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
    func removeAllLocation() {
        let request: NSFetchRequest<NSFetchRequestResult> = Location.fetchRequest()
        let delete = NSBatchDeleteRequest(fetchRequest: request)
        
        do {
            try self.container.viewContext.execute(delete)
            WolleyLog.debug("ë¡œì¼€ì´ì…˜ ë°ì´í„° ì „ì²´ ì‚­ì œ ì™„ë£Œ")
            
        } catch {
            WolleyLog.error("ë¡œì¼€ì´ì…˜ ë°ì´í„° ì „ì²´ ì‚­ì œ ì‹¤íŒ¨")
        }
    }
    ```
    

### 7. ëŒ€ì²´ ì†”ë£¨ì…˜

Appleì—ì„œ ì•±ì´ ì¢…ë£Œ ë˜ì—ˆì„ ì‹œì—ë„ ì‘ë™í•˜ëŠ” ê¸°ëŠ¥ ë¦¬ìŠ¤íŠ¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

[Apple Developer Documentation](https://developer.apple.com/documentation/corelocation/getting_the_user_s_location/handling_location_events_in_the_background)

ì—¬ê¸°ì„œ Yesë¼ê³  ì‘ì„±ë˜ì–´ìˆëŠ” ì„œë¹„ìŠ¤ì˜ ê²½ìš° suspendì‹œì—ë„ ìœ„ì¹˜ ì¶”ì ì´ ê°€ëŠ¥í•œ ê¸°ëŠ¥ì…ë‹ˆë‹¤. í•´ë‹¹ í”Œë«í¼ì˜ ê²½ìš° significant-change location serviceì™€ region monitoring ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤. Visits serviceë¥¼ í™œìš©í•˜ëŠ” ë°©ë²•ì€ êµ¬í˜„í•´ë³´ì§€ëŠ” ì•Šì•˜ì§€ë§Œ suspend ì‹œì— ìœ„ì¹˜ ì¶”ì ì„ ì§„í–‰í•˜ëŠ” ê²½ìš° ë„ì›€ì´ ë  ìˆ˜ë„ ìˆì„ ê²ƒì´ë¼ê³  ìƒê°í•©ë‹ˆë‹¤.

![ìŠ¤í¬ë¦°ìƒ· 2022-02-24 ì˜¤í›„ 4.42.49.png](Suspend%20%E1%84%89%E1%85%A1%2027e45/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-02-24_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.42.49.png)

### 8. ì£¼ì˜ ì‚¬í•­

- ìœ„ì¹˜ ì •ë³´ëŠ” ì•± ì „ì—­ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê¸°ëŠ¥ì´ê¸°ì—, Location Managerì´ View ì•ˆì— ì¢…ì†ë˜ì–´ìˆì§€ ì•Šì•„ì•¼ í•©ë‹ˆë‹¤. (í•´ë‹¹ ì•±ì˜ ê²½ìš° LocationServiceë¼ëŠ” classë¥¼ ë…ë¦½ì ìœ¼ë¡œ ë¶„ë¦¬í•˜ì—¬ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.)
- ì•„ë˜ í˜ì´ì§€ì— ê¸°ì¬ë˜ì–´ìˆëŠ” í™˜ê²½ì´ ëª¨ë‘ ì„¸íŒ…ë˜ì–´ìˆì§€ ì•Šìœ¼ë©´ ìœ„ì¹˜ ì¶”ì ì´ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ì§€ ì•Šì„ ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤.
    
    [Wolley - ìœ„ì¹˜ ì •ë³´ê°€ ì •í™•í•˜ê²Œ ì‘ë™í•˜ì§€ ì•ŠëŠ” ê²½ìš°ëŠ” ì–´ë–¤ ê²½ìš°ì¸ê°€ìš”â“](https://www.notion.so/Wolley-0366e0fc06d349f7afd7b71a6d3ca91f)
